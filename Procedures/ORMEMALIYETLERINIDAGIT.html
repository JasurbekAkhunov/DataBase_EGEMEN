<HTML>
<HEAD>
<TITLE>ORMEMALIYETLERINIDAGIT</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK HREF="../IBEHTMLDoc.css" type=text/css rel=STYLESHEET>
 
<xml>
<IBEHelp:Attr Name="ItemOrder" Value="1284800"/>
</xml>
 
</HEAD>
<BODY>
<DIV ID="nsbanner">
  <DIV ID="bannerrow1">
    <TABLE CLASS="bannerparthead" CELLSPACING=0>
      <TR ID="hdr" VALIGN="middle">
        <TD CLASS="runninghead">"E:\Egemen\EB01\Dataserver\DATA\FERGANAGLOBAL\EB01DATA.GDB". Procedures</TD>
        <TD ALIGN="left" WIDTH="54px" NOWRAP>
          <A HREF="ORMEMALIYETLERIHESAPLA_IC.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
          <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
          <A HREF="ORMEMPBAZINDACALISMARAPORU.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
        </TD>
      </TR>
    </TABLE>
  </DIV>
  <DIV ID="TitleRow">
    <P CLASS="dtH1">ORMEMALIYETLERINIDAGIT</P>
  </DIV>
 </DIV>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Input Parameters</P>
<TABLE CLASS="dtArg" CELLSPACING="0">
  <TH WIDTH="1%"><P CLASS="Base2"><B>Parameter</B></P>
  <TH WIDTH="20%"><P CLASS="Base2"><B>Type</B></P>
  <TH WIDTH="50%"><P CLASS="Base2"><B>Description</B></P>
  <TR>
    <TD><P CLASS="Base2">ABASLANGICTARIHI</TD>
    <TD><P CLASS="Base2">TIMESTAMP</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ABITISTARIHI</TD>
    <TD><P CLASS="Base2">TIMESTAMP</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
</TABLE>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Output Parameters</P>
<TABLE CLASS="dtArg" CELLSPACING="0">
  <TH WIDTH="1%"><P CLASS="Base2"><B>Parameter</B></P>
  <TH WIDTH="20%"><P CLASS="Base2"><B>Type</B></P>
  <TH WIDTH="50%"><P CLASS="Base2"><B>Description</B></P>
  <TR>
    <TD><P CLASS="Base2">YIL</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">AY</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TEMPTARIH1</TD>
    <TD><P CLASS="Base2">TIMESTAMP</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TEMPTARIH2</TD>
    <TD><P CLASS="Base2">TIMESTAMP</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">AYTOPLAMORMEURETIMKILO</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">AYTOPLAMORMEURETIMKILO1</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKGENELURETIMGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKELEKTRIKGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKDOGALGAZGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKBUHARGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKSUGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKISCILIKGIDERI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ORMEAYLIKGIDERTOPLAMI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">HAMID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">HAMADI</TD>
    <TD><P CLASS="Base2">VARCHAR(255)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PUS</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FEINE</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TOPLAMORMEURETIMKILO</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">MALIYETKATSAYISI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">GENELURETIMGIDERPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">GENELURETIMGIDERPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ELEKTRIKPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ELEKTRIKPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">DOGALGAZPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">DOGALGAZPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">BUHARPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">BUHARPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SUPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SUPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ISCILIKPAYIORANI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ISCILIKPAYITUTARI</TD>
    <TD><P CLASS="Base2">DOUBLE PRECISION</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
</TABLE>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Description</P>
<P CLASS="Base"><I>(There is no description for procedure ORMEMALIYETLERINIDAGIT)</I></P>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Definition</P>
<P CLASS="Base"><span class="DDLCode">
<code><pre>
<b>CREATE</b><b> </b><b>PROCEDURE</b><b> </b><font color="# 080 0"><u>ORMEMALIYETLERINIDAGIT</u></font><b>(</b>
<b>    </b>ABASLANGICTARIHI<b> </b><b>TIMESTAMP</b><b>,</b>
<b>    </b>ABITISTARIHI<b> </b><b>TIMESTAMP</b><b>)</b>
<b>RETURNS</b><b> </b><b>(</b>
<b>    </b>YIL<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>AY<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>TEMPTARIH1<b> </b><b>TIMESTAMP</b><b>,</b>
<b>    </b>TEMPTARIH2<b> </b><b>TIMESTAMP</b><b>,</b>
<b>    </b>AYTOPLAMORMEURETIMKILO<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>AYTOPLAMORMEURETIMKILO1<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKGENELURETIMGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKELEKTRIKGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKDOGALGAZGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKBUHARGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKSUGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKISCILIKGIDERI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ORMEAYLIKGIDERTOPLAMI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>HAMID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>HAMADI<b> </b><b>VARCHAR</b><b>(</b>255<b>)</b><b>,</b>
<b>    </b>PUS<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>FEINE<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>TOPLAMORMEURETIMKILO<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>MALIYETKATSAYISI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>GENELURETIMGIDERPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>GENELURETIMGIDERPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ELEKTRIKPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ELEKTRIKPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>DOGALGAZPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>DOGALGAZPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>BUHARPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>BUHARPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>SUPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>SUPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ISCILIKPAYIORANI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>,</b>
<b>    </b>ISCILIKPAYITUTARI<b> </b><b>DOUBLE</b><b> </b><b>PRECISION</b><b>)</b>
<b>AS</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FStokHareketId<b> </b><b>integer</b><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FBirimMaliyet<b> </b><b>Double</b><b> </b><b>Precision</b><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FRafGirisindeMaliyetiEsitle<b> </b><b>integer</b><b> </b><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FORafBirimMaliyetTakibiOlmasin<b> </b><b>integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FSiparisMaliyetTakibiVar<b> </b><b>integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>SistemDovizId<b> </b><font color="# 080 0"><u>DovizSize</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>DovizId<b> </b><font color="# 080 0"><u>DovizSize</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>Tarih<b>  </b><b>TimeStamp</b><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b><font color="# 080 0"><u>DovizKuru</u></font><b> </b><b>Double</b><b> </b><b>Precision</b><b>;</b>
<b>Begin</b>
<b>  </b><font color="# 0 0FF"><i>/*Aylık ünite giderleri tablosuna yazılan maliyetler SistemDovizID biriminden olmalı*/</i></font>
<b>  </b><b>Select</b><b> </b>RafGirisindeMaliyetiEsitle<b>,</b><b> </b>ORafBirimMaliyetTakibiOlmasin<b>,</b><b>  </b>SiparisMaliyetTakibiVar<b>,</b><b> </b>SistemDovizId<b> </b><b>From</b><b> </b><font color="# 080 0"><u>Sistem</u></font>
<b>  </b><b>Where</b><b> </b>SistemId<b> </b><b>=</b><b> </b>1
<b>  </b><b>Into</b><b> </b>:FRafGirisindeMaliyetiEsitle<b>,</b><b> </b>:FORafBirimMaliyetTakibiOlmasin<b>,</b><b> </b>:FSiparisMaliyetTakibiVar<b>,</b><b> </b>:SistemDovizId<b>;</b>

<b>  </b><b>Update</b><b> </b><font color="# 080 0"><u>Sistem</u></font>
<b>  </b><b>Set</b>
<b>    </b>RafGirisindeMaliyetiEsitle<b> </b><b>=</b><b> </b>0<b>,</b>
<b>    </b>ORafBirimMaliyetTakibiOlmasin<b> </b><b>=</b><b> </b>1
<b>  </b><b>Where</b><b> </b><font color="# 080 0"><u>Sistem</u></font><b>.</b>SistemId<b> </b><b>=</b>1<b> </b><b>;</b>

<b>  </b><b>For</b><b> </b><b>Select</b><b> </b><font color="# 080 0"><u>f_year</u></font><b>(</b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b>)</b><b>,</b><b> </b><font color="# 080 0"><u>f_month</u></font><b>(</b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b>)</b>
<b>      </b><b>From</b><b> </b><font color="# 080 0"><u>Stokhareket</u></font>
<b>      </b><b>Where</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&gt;</b><b>=</b><b> </b>:ABaslangicTarihi<b> </b><b>and</b><b> </b><font color="# 080 0"><u>Stokhareket</u></font><b>.</b>Tarih<b> </b><b>&lt;</b><b>=</b><b> </b>:ABitisTarihi<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>UretimIslemTipiId<b> </b><b>=</b><b> </b>1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HareketTipi<b> </b><b>=</b><b> </b>9<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamIade<b> </b><b>=</b><b> </b>0
<b>      </b><b>Group</b><b> </b><b>by</b><b> </b><font color="# 080 0"><u>F_year</u></font><b>(</b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b>)</b><b>,</b><b> </b><font color="# 080 0"><u>F_month</u></font><b>(</b><font color="# 080 0"><u>Stokhareket</u></font><b>.</b>Tarih<b>)</b>
<b>      </b><b>Into</b><b> </b>:Yil<b>,</b><b> </b>:Ay<b> </b><b>do</b>
<b>  </b><b>Begin</b>
<b>    </b><b>Delete</b><b> </b><b>From</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b> </b><b>Where</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Yil<b> </b><b>=</b><b> </b>:Yil<b> </b><b>And</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Ay<b> </b><b>=</b><b> </b>:Ay<b> </b><b>;</b>

<b>    </b>AyToplamOrmeUretimKilo<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>AyToplamOrmeUretimKilo1<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>

<b>    </b>Ormeaylikgeneluretimgideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>Ormeaylikelektrikgideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>Ormeaylikdogalgazgideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>Ormeaylikbuhargideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>Ormeayliksugideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>    </b>Ormeaylikiscilikgideri<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>

<b>    </b>Ormeaylikgidertoplami<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>

<b>    </b>TempTarih1<b> </b><b>=</b><b> </b><b>Cast</b><b>(</b>'01.'<b>|</b><b>|</b>:Ay<b>|</b><b>|</b>'.'<b>|</b><b>|</b><b> </b>:Yil<b> </b><b>As</b><b> </b><b>Timestamp</b><b>)</b><b> </b><b>;</b>
<b>    </b>TempTarih2<b> </b><b>=</b><b> </b><b>Dateadd</b><b>(</b>1<b> </b><b>Month</b><b> </b><b>To</b><b> </b>TempTarih1<b>)</b><b> </b><b>;</b>

<b>    </b><b>Select</b><b> </b><b>Sum</b><b>(</b>Miktar<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b>Miktar<b> </b><b>*</b><b> </b><b>Coalesce</b><b>(</b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>MaliyetKatsayisi<b>,</b><b> </b>1<b>)</b><b>)</b>
<b>    </b><b>From</b><b> </b><font color="# 080 0"><u>StokHareket</u></font>
<b>    </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>OrmeSiparisDetay</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>OrmeSiparisDetay</u></font><b>.</b>OrmeSiparisDetayId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>OrmeSiparisDetayId
<b>    </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>Ham</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>HamId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamId
<b>    </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>HamGrupid<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>HamGrup1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>IntKarsilastir</u></font><b>(</b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>Pus<b>,</b><b> </b><font color="# 080 0"><u>OrmeSiparisDetay</u></font><b>.</b>Pus<b>)</b><b> </b><b>=</b><b> </b>1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>IntKarsilastir</u></font><b>(</b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>Feine<b>,</b><b> </b><font color="# 080 0"><u>OrmeSiparisDetay</u></font><b>.</b>Feine<b>)</b><b> </b><b>=</b><b> </b>1
<b>    </b><font color="# 0 0FF"><i>--Left Join OrmeMaliyetKatsayi on OrmeMaliyetKatsayi.Hamid = StokHareket.Hamid and IntKarsilastir(OrmeMaliyetKatsayi.Pus, OrmeSiparisDetay.Pus) = 1 And IntKarsilastir(OrmeMaliyetKatsayi.Feine, OrmeSiparisDetay.Feine) = 1</i></font>
<b>    </b><b>Where</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&gt;</b><b>=</b><b> </b>:TempTarih1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&lt;</b><b> </b>:TempTarih2<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>UretimIslemTipiId<b> </b><b>=</b><b> </b>1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HareketTipi<b> </b><b>=</b><b> </b>9<b> </b><b>and</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamIade<b> </b><b>=</b><b> </b>0
<b>    </b><b>Into</b><b> </b>:AyToplamOrmeUretimKilo<b>,</b><b> </b>:AyToplamOrmeUretimKilo1<b> </b><b>;</b>


<b>  </b><font color="# 0 0FF"><i>/*Aylık ünite giderleri tablosuna yazılan maliyetler SistemDovizID biriminden olmalı*/</i></font>
<b>    </b><b>Select</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>GenelUretimGideri<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>Elektrikgideri<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>Dogalgazgideri<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>Buhargideri<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>Sugideri<b>)</b><b>,</b><b> </b><b>Sum</b><b>(</b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>iscilikgideri<b>)</b>
<b>    </b><b>From</b><b> </b><font color="# 080 0"><u>AylikuniteGiderleri</u></font>
<b>    </b><b>Where</b><b> </b><font color="# 080 0"><u>AylikuniteGiderleri</u></font><b>.</b>UniteId<b> </b><b>=</b><b> </b><b>(</b><b>Select</b><b> </b>UniteId<b> </b><b>From</b><b> </b><font color="# 080 0"><u>Unite</u></font><b> </b><b>Where</b><b> </b><font color="# 080 0"><u>Unite</u></font><b>.</b>OrmeUnitesimi<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>And</b><b> </b>Yil<b> </b><b>=</b><b> </b>:Yil<b> </b><b>And</b><b> </b>Ay<b> </b><b>=</b><b> </b>:Ay
<b>    </b><b>Into</b><b> </b>:Ormeaylikgeneluretimgideri<b>,</b><b> </b>:Ormeaylikelektrikgideri<b>,</b><b> </b>:Ormeaylikdogalgazgideri<b>,</b><b> </b>:Ormeaylikbuhargideri<b>,</b><b> </b>:Ormeayliksugideri<b>,</b><b> </b>:Ormeaylikiscilikgideri<b> </b><b>;</b>

<b>    </b>Ormeaylikgidertoplami<b> </b><b>=</b><b> </b>Ormeaylikgeneluretimgideri<b> </b><b>+</b><b>  </b>Ormeaylikelektrikgideri<b> </b><b>+</b><b> </b>Ormeaylikdogalgazgideri<b> </b><b>+</b><b> </b>Ormeaylikbuhargideri<b> </b><b>+</b><b> </b>Ormeayliksugideri<b> </b><b>+</b><b> </b>Ormeaylikiscilikgideri<b> </b><b>;</b>

<b>    </b><b>For</b><b> </b><b>Select</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamId<b>,</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>Adi<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Pus<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Feine<b>,</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>MaliyetKatsayisi<b>,</b><b> </b><b>Sum</b><b>(</b>Miktar<b>)</b>
<b>        </b><b>From</b><b> </b><font color="# 080 0"><u>StokHareket</u></font>
<b>        </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b> </b><b>On</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Ormesiparisdetayid<b> </b><b>=</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Ormesiparisdetayid
<b>        </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>Ham</u></font><b> </b><b>On</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>HamId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamId
<b>        </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b> </b><b>On</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>HamGrupId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>HamGrup1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>IntKarsilastir</u></font><b>(</b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>Pus<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Pus<b>)</b><b> </b><b>=</b><b> </b>1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>IntKarsilastir</u></font><b>(</b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>Feine<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Feine<b>)</b><b> </b><b>=</b><b> </b>1
<b>        </b><font color="# 0 0FF"><i>--Left Join OrmeMaliyetKatsayi On OrmeMaliyetKatsayi.HamId = StokHareket.HamId and IntKarsilastir(OrmeMaliyetKatsayi.Pus, Ormesiparisdetay.Pus) = 1 And IntKarsilastir(OrmeMaliyetKatsayi.Feine, Ormesiparisdetay.Feine) = 1</i></font>
<b>        </b><b>Where</b><b> </b><font color="# 080 0"><u>Stokhareket</u></font><b>.</b>Tarih<b> </b><b>&gt;</b><b>=</b><b> </b>:TempTarih1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&lt;</b><b> </b>:TempTarih2<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>UretimIslemTipiId<b> </b><b>=</b><b> </b>1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HareketTipi<b> </b><b>=</b><b> </b>9<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamIade<b> </b><b>=</b><b> </b>0
<b>        </b><b>Group</b><b> </b><b>by</b><b>  </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamId<b>,</b><b> </b><font color="# 080 0"><u>Ham</u></font><b>.</b>Adi<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Pus<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Feine<b>,</b><b> </b><font color="# 080 0"><u>OrmeMaliyetGrupKatsayi</u></font><b>.</b>MaliyetKatsayisi
<b>        </b><b>Into</b><b> </b>:HamId<b>,</b><b> </b>:HamAdi<b>,</b><b> </b>:Pus<b>,</b><b> </b>:Feine<b>,</b><b> </b>:MaliyetKatsayisi<b>,</b><b> </b>:ToplamOrmeUretimKilo<b> </b><b>Do</b>
<b>    </b><b>Begin</b>
<b>      </b><b>If</b><b> </b><b>(</b>MaliyetKatsayisi<b> </b><b>is</b><b> </b><b>null</b><b>)</b><b> </b><b>Then</b><b> </b>MaliyetKatsayisi<b> </b><b>=</b><b> </b>1<b> </b><b>;</b>
<b>      </b>GenelUretimGiderPayiOrani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>GenelUretimGiderPayiTutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Elektrikpayiorani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Elektrikpayitutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Dogalgazpayiorani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Dogalgazpayitutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Buharpayiorani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Buharpayitutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Supayiorani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Supayitutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Iscilikpayiorani<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b>Iscilikpayitutari<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b><b>If</b><b> </b><b>(</b>ToplamOrmeUretimKilo<b> </b><b>is</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b><b> </b>ToplamOrmeUretimKilo<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b><b>If</b><b> </b><b>(</b>AyToplamOrmeUretimKilo1<b> </b><b>is</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b><b> </b>AyToplamOrmeUretimKilo1<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>

<b>      </b><b>If</b><b> </b><b>(</b>ToplamOrmeUretimKilo<b> </b><b>&lt;</b><b>&gt;</b><b> </b>0<b> </b><b>And</b><b> </b>AyToplamOrmeUretimKilo1<b> </b><b>&lt;</b><b>&gt;</b><b> </b>0<b> </b><b>)</b><b> </b><b>Then</b>
<b>      </b><b>Begin</b>
<b>        </b><font color="# 0 0FF"><i>/* örmede enerji paylarının ayrıca ayrı dağıtılması durumu yok şu an için o yüzden GenelUretimGiderPayiOrani diğerlerine uygulandı*/</i></font>
<b>        </b>GenelUretimGiderPayiOrani<b> </b><b>=</b><b> </b>ToplamOrmeUretimKilo<b> </b><b>*</b><b> </b>MaliyetKatsayisi<b> </b><b>/</b><b> </b>AyToplamOrmeUretimKilo1<b> </b><b>*</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Elektrikpayiorani<b> </b><b>=</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>;</b>
<b>        </b>Dogalgazpayiorani<b> </b><b>=</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>;</b>
<b>        </b>Buharpayiorani<b> </b><b>=</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>;</b>
<b>        </b>Supayiorani<b> </b><b>=</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>;</b>
<b>        </b>Iscilikpayiorani<b> </b><b>=</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>;</b>
<b>      </b><b>End</b>

<b>      </b><b>If</b><b> </b><b>(</b>GenelUretimGiderPayiOrani<b>&lt;</b><b>&gt;</b>0<b> </b><b>and</b><b> </b>Ormeaylikgidertoplami<b>&lt;</b><b>&gt;</b><b> </b>0<b>)</b><b> </b><b>Then</b>
<b>      </b><b>Begin</b>
<b>        </b>GenelUretimGiderPayiTutari<b> </b><b>=</b><b> </b>Ormeaylikgeneluretimgideri<b> </b><b>*</b><b> </b>GenelUretimGiderPayiOrani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Elektrikpayitutari<b> </b><b>=</b><b> </b>Ormeaylikelektrikgideri<b> </b><b>*</b><b> </b>Elektrikpayiorani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Dogalgazpayitutari<b> </b><b>=</b><b> </b>Ormeaylikdogalgazgideri<b> </b><b>*</b><b> </b>Dogalgazpayiorani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Buharpayitutari<b> </b><b>=</b><b> </b>Ormeaylikbuhargideri<b> </b><b>*</b><b> </b>Buharpayiorani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Supayitutari<b> </b><b>=</b><b> </b>Ormeayliksugideri<b> </b><b>*</b><b> </b>Supayiorani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>        </b>Iscilikpayitutari<b> </b><b>=</b><b> </b>Ormeaylikiscilikgideri<b> </b><b>*</b><b> </b>Iscilikpayiorani<b> </b><b>/</b><b> </b>100<b> </b><b>;</b>
<b>      </b><b>End</b>

<b>      </b><b>Insert</b><b> </b><b>Into</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>(</b>Yil<b>,</b><b> </b>Ay<b>,</b><b> </b>HamId<b>,</b><b> </b>Pus<b>,</b><b> </b>Feine<b>,</b>
<b>        </b>GenelUretimGiderPayiOrani<b>,</b><b> </b>GenelUretimGiderPayiTutari<b>,</b>
<b>        </b>Elektrikpayiorani<b>,</b><b> </b>Elektrikpayitutari<b>,</b>
<b>        </b>Dogalgazpayiorani<b>,</b><b> </b>Dogalgazpayitutari<b>,</b>
<b>        </b>Buharpayiorani<b>,</b><b> </b>Buharpayitutari<b>,</b>
<b>        </b>Supayiorani<b>,</b><b> </b>Supayitutari<b>,</b>
<b>        </b>Iscilikpayiorani<b>,</b><b> </b>Iscilikpayitutari<b>,</b>
<b>        </b>ToplamUretimKilo<b>)</b>
<b>      </b><b>Values</b><b>(</b>:Yil<b>,</b><b> </b>:Ay<b>,</b><b> </b>:HamId<b>,</b><b> </b>:Pus<b>,</b><b> </b>:Feine<b>,</b>
<b>        </b>:GenelUretimGiderPayiOrani<b>,</b><b> </b>:GenelUretimGiderPayiTutari<b>,</b>
<b>        </b>:Elektrikpayiorani<b>,</b><b> </b>:Elektrikpayitutari<b>,</b>
<b>        </b>:Dogalgazpayiorani<b>,</b><b> </b>:Dogalgazpayitutari<b>,</b>
<b>        </b>:Buharpayiorani<b>,</b><b> </b>:Buharpayitutari<b>,</b>
<b>        </b>:Supayiorani<b>,</b><b> </b>:Supayitutari<b>,</b>
<b>        </b>:Iscilikpayiorani<b>,</b><b> </b>:Iscilikpayitutari<b>,</b>
<b>        </b>:ToplamOrmeUretimKilo<b>)</b><b> </b><b>;</b>

<b>      </b><b>Suspend</b><b> </b><b>;</b>
<b>    </b><b>End</b>

<b>    </b><b>For</b><b> </b><b>Select</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>StokHareketId<b>,</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamId<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Pus<b>,</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Feine<b>,</b><b> </b><b>(</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>GenelUretimGiderPayiTutari<b> </b><b>+</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>ElektrikPayiTutari<b> </b><b>+</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>DogalgazPayiTutari<b> </b><b>+</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>BuharPayiTutari<b> </b><b>+</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>SuPayiTutari<b> </b><b>+</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>IscilikPayiTutari<b>)</b><b>,</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>ToplamUretimKilo<b>,</b>
<b>               </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>DovizId<b>,</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b>  </b><b>From</b><b> </b><font color="# 080 0"><u>StokHareket</u></font>
<b>        </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b> </b><b>On</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Ormesiparisdetayid<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Stokhareket</u></font><b>.</b>Ormesiparisdetayid
<b>        </b><b>Left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b> </b><b>On</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Yil<b> </b><b>=</b><b> </b>:Yil<b> </b><b>And</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Ay<b> </b><b>=</b><b> </b>:Ay<b> </b><b>And</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>HamId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Stokhareket</u></font><b>.</b>HamId<b> </b><b>And</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Pus<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Pus<b> </b><b>And</b><b> </b><font color="# 080 0"><u>OrmeMaliyetDagilimi</u></font><b>.</b>Feine<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Ormesiparisdetay</u></font><b>.</b>Feine
<b>        </b><b>Where</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&gt;</b><b>=</b><b> </b>:TempTarih1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>Tarih<b> </b><b>&lt;</b><b> </b>:TempTarih2<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>UretimIslemTipiId<b> </b><b>=</b><b> </b>1<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HareketTipi<b> </b><b>=</b><b> </b>9<b> </b><b>And</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>HamIade<b> </b><b>=</b><b> </b>0
<b>        </b><b>Into</b><b> </b>:FStokHareketId<b>,</b><b> </b>:HamId<b>,</b><b> </b>:Pus<b>,</b><b> </b>:Feine<b>,</b><b> </b>:Ormeaylikgidertoplami<b>,</b><b> </b>:ToplamOrmeUretimKilo<b>,</b><b> </b>:DovizId<b>,</b><b> </b>:Tarih<b> </b><b>Do</b>
<b>    </b><b>Begin</b>
<b>      </b>FBirimMaliyet<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b><b>If</b><b> </b><b>(</b>Ormeaylikgidertoplami<b> </b><b>is</b><b> </b><b>null</b><b>)</b><b> </b><b>Then</b><b> </b>Ormeaylikgidertoplami<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>
<b>      </b><b>If</b><b> </b><b>(</b>ToplamOrmeUretimKilo<b> </b><b>is</b><b> </b><b>null</b><b>)</b><b> </b><b>Then</b><b> </b>ToplamOrmeUretimKilo<b> </b><b>=</b><b> </b>0<b> </b><b>;</b>

<b>      </b><b>If</b><b> </b><b>(</b><b> </b><b>(</b>Ormeaylikgidertoplami<b>&lt;</b><b>&gt;</b><b> </b>0<b>)</b><b> </b><b>And</b><b> </b><b>(</b><b> </b>ToplamOrmeUretimKilo<b> </b><b>&lt;</b><b>&gt;</b><b> </b>0<b> </b><b>)</b><b> </b><b>)</b><b> </b><b>Then</b><b> </b>FBirimMaliyet<b> </b><b>=</b><b> </b>Ormeaylikgidertoplami<b> </b><b>/</b><b> </b>ToplamOrmeUretimKilo<b> </b><b>;</b>

<b>      </b><b>if</b><b> </b><b>(</b>SistemDovizId<b> </b><b>&lt;</b><b>&gt;</b><b> </b>DovizID<b>)</b><b> </b><b>then</b>
<b>        </b><b>select</b><b> </b><font color="# 080 0"><u>DovizKuru</u></font><b> </b><b>from</b><b> </b><font color="# 080 0"><u>EnYakinDovizKuruGetir</u></font><b>(</b>:DovizId<b>,</b><b> </b>:SistemDovizId<b>,</b><b> </b>:Tarih<b>)</b><b> </b><b>into</b><b> </b>:DovizKuru<b>;</b>
<b>      </b><b>else</b>
<b>        </b><font color="# 080 0"><u>DovizKuru</u></font><b> </b><b>=</b><b> </b>1<b>;</b>

<b>      </b>FBirimMaliyet<b> </b><b>=</b><b> </b>FBirimMaliyet<b> </b><b>*</b><b> </b><font color="# 080 0"><u>Dovizkuru</u></font><b> </b><b>;</b>

<b>      </b><b>Update</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b> </b><b>Set</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>BirimFiyat<b> </b><b>=</b><b> </b>:FBirimMaliyet<b>,</b><b> </b>NeredenUpdate<b> </b><b>=</b><b> </b>4<b>,</b><b> </b>LinkIslemi<b> </b><b>=</b><b> </b>1
<b>      </b><b>Where</b><b> </b><font color="# 080 0"><u>StokHareket</u></font><b>.</b>StokHareketId<b> </b><b>=</b><b> </b>:FStokHareketId<b>  </b><b>;</b>

<b>    </b><b>End</b>

<b>  </b><b>End</b>

<b>  </b><b>Update</b><b> </b><font color="# 080 0"><u>sistem</u></font>
<b>  </b><b>Set</b>
<b>    </b>RafGirisindeMaliyetiEsitle<b> </b><b>=</b><b> </b>:FRafGirisindeMaliyetiEsitle<b>,</b>
<b>    </b>ORafBirimMaliyetTakibiOlmasin<b> </b><b>=</b><b> </b>:FORafBirimMaliyetTakibiOlmasin<b>,</b>
<b>    </b>SiparisMaliyetTakibiVar<b> </b><b>=</b><b> </b>:FSiparisMaliyetTakibiVar
<b>  </b><b>Where</b><b> </b><font color="# 080 0"><u>Sistem</u></font><b>.</b>SistemId<b> </b><b>=</b>1<b> </b><b>;</b>
<b>end</b>

</pre></code>
</span></P>
<P CLASS="Base">&nbsp;</P>
<DIV CLASS="footer"><BR><HR></DIV>
  <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH=100%>
    <TR VALIGN="middle">
      <TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
      <TD ALIGN="left" WIDTH="54px" NOWRAP>
        <A HREF="ORMEMALIYETLERIHESAPLA_IC.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
        <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
        <A HREF="ORMEMPBAZINDACALISMARAPORU.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
      </TD>
    </TR>
  </TABLE>
<P CLASS="Base">&nbsp;</P>
</BODY></HTML>