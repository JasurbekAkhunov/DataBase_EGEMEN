<HTML>
<HEAD>
<TITLE>LOGLA</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK HREF="../IBEHTMLDoc.css" type=text/css rel=STYLESHEET>
 
<xml>
<IBEHelp:Attr Name="ItemOrder" Value="1050800"/>
</xml>
 
</HEAD>
<BODY>
<DIV ID="nsbanner">
  <DIV ID="bannerrow1">
    <TABLE CLASS="bannerparthead" CELLSPACING=0>
      <TR ID="hdr" VALIGN="middle">
        <TD CLASS="runninghead">"E:\Egemen\EB01\Dataserver\DATA\FERGANAGLOBAL\EB01DATA.GDB". Procedures</TD>
        <TD ALIGN="left" WIDTH="54px" NOWRAP>
          <A HREF="LOGGETIR.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
          <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
          <A HREF="LOGMAPPINGDETAILGETIR.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
        </TD>
      </TR>
    </TABLE>
  </DIV>
  <DIV ID="TitleRow">
    <P CLASS="dtH1">LOGLA</P>
  </DIV>
 </DIV>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Input Parameters</P>
<TABLE CLASS="dtArg" CELLSPACING="0">
  <TH WIDTH="1%"><P CLASS="Base2"><B>Parameter</B></P>
  <TH WIDTH="20%"><P CLASS="Base2"><B>Type</B></P>
  <TH WIDTH="50%"><P CLASS="Base2"><B>Description</B></P>
  <TR>
    <TD><P CLASS="Base2">TIP</TD>
    <TD><P CLASS="Base2">CHAR(1)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">CALISMAMODU</TD>
    <TD><P CLASS="Base2">SMALLINT</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TABLOADI</TD>
    <TD><P CLASS="Base2">VARCHAR(32)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">KEYFIELDNAME</TD>
    <TD><P CLASS="Base2">VARCHAR(32)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">KEYVALUE</TD>
    <TD><P CLASS="Base2">VARCHAR(255)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ANAHTAR</TD>
    <TD><P CLASS="Base2">VARCHAR(4000)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
</TABLE>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Output Parameters</P>
<P CLASS="Base"><I>(There are no output parameters)</I></P>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Description</P>
<P CLASS="Base"><I>(There is no description for procedure LOGLA)</I></P>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Definition</P>
<P CLASS="Base"><span class="DDLCode">
<code><pre>
<b>CREATE</b><b> </b><b>PROCEDURE</b><b> </b><font color="# 080 0"><u>LOGLA</u></font><b>(</b>
<b>    </b>TIP<b> </b><b>CHAR</b><b>(</b>1<b>)</b><b>,</b>
<b>    </b>CALISMAMODU<b> </b><b>SMALLINT</b><b>,</b>
<b>    </b>TABLOADI<b> </b><b>VARCHAR</b><b>(</b>32<b>)</b><b>,</b>
<b>    </b>KEYFIELDNAME<b> </b><b>VARCHAR</b><b>(</b>32<b>)</b><b>,</b>
<b>    </b>KEYVALUE<b> </b><b>VARCHAR</b><b>(</b>255<b>)</b><b>,</b>
<b>    </b>ANAHTAR<b> </b><b>VARCHAR</b><b>(</b>4000<b>)</b><b>)</b>
<b>AS</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>LogMasterId<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDegerEski<b> </b><b>Blob</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FLogMappingId<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulAlani<b> </b><font color="# 080 0"><u>Adi100</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulDegeri<b> </b><b>Varchar</b><b>(</b>255<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulOperatoru<b> </b><b>Varchar</b><b>(</b>5<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FLogMappingDetailAlani<b> </b><font color="# 080 0"><u>Adi100</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FForeignTabloDegerAlani<b> </b><font color="# 080 0"><u>Adi100</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FForeignTabloAlani<b> </b><font color="# 080 0"><u>Adi100</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FForeignTablo<b> </b><font color="# 080 0"><u>Adi100</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FTabloKolonlari<b> </b><b>Varchar</b><b>(</b>5000<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDevam<b> </b><font color="# 080 0"><u>Egeboolean</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulVar<b> </b><font color="# 080 0"><u>Egeboolean</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulUygunMu<b> </b><font color="# 080 0"><u>Egeboolean</u></font><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FAlanSayisi<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FAlanSira<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FSqlCumlesi<b> </b><b>Blob</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FAlan<b> </b><b>Varchar</b><b>(</b>50<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FAlanUzunluk<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FVirgulPozisyonu<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FSonVirgulPozisyonu<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FSqlSonucu<b> </b><b>Blob</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKolonTag<b> </b><b>Varchar</b><b>(</b>500<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDegerTag<b> </b><b>Varchar</b><b>(</b>500<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKolonTagPozisyonu1<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKolonTagPozisyonu2<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDegerTagPozisyonu1<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDegerTagPozisyonu2<b> </b><b>Integer</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKolon<b> </b><b>Varchar</b><b>(</b>32<b>)</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FDeger<b> </b><b>Blob</b><b>;</b>
<b>Declare</b><b> </b><b>Variable</b><b> </b>FKosulSonucu<b> </b><font color="# 080 0"><u>Egeboolean</u></font><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FLogTemizlemeGunSayisi<b> </b><b>Smallint</b><b>;</b>
<b>begin</b>
<b>    </b><font color="# 0 0FF"><i>/*</i></font>
<font color="# 0 0FF"><i>    Select LogTemizlemeGunSayisi From Sistem Where SistemId = 1 Into :FLogTemizlemeGunSayisi;</i></font>

<font color="# 0 0FF"><i>    if (FLogTemizlemeGunSayisi &gt; 0) then</i></font>
<font color="# 0 0FF"><i>    begin</i></font>
<font color="# 0 0FF"><i>        delete from LogDetay Where LogDetay.LogMasterid in (Select LogMasterId From LogMaster Where LogMaster.Tarih &lt; Current_date - :FLogTemizlemeGunSayisi);</i></font>
<font color="# 0 0FF"><i>        Delete From LogMaster Where LogMaster.Tarih &lt; Current_date - :FLogTemizlemeGunSayisi;</i></font>
<font color="# 0 0FF"><i>    end</i></font>
<font color="# 0 0FF"><i>    */</i></font>

<b>    </b><b>for</b><b> </b><b>Select</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>LogMappingId<b>,</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>TabloKosulAlani<b>,</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>TabloKosulDegeri<b>,</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>TabloKosulOperatoru<b> </b><b>From</b><b> </b><font color="# 080 0"><u>LogMapping</u></font>
<b>        </b><b>Where</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>TabloAdi<b> </b><b>=</b><b> </b>:TabloAdi<b> </b><b>And</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>Kapali<b> </b><b>=</b><b> </b>0<b> </b><b>And</b><b> </b><b>(</b><b>(</b>:Tip<b> </b><b>=</b><b> </b>'D'<b> </b><b>and</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>Tipi<b> </b><b>In</b><b> </b><b>(</b>0<b>,</b><b> </b>1<b>)</b><b>)</b><b> </b><b>or</b><b> </b><b>(</b>:Tip<b> </b><b>=</b><b> </b>'U'<b> </b><b>and</b><b> </b><font color="# 080 0"><u>LogMapping</u></font><b>.</b>Tipi<b> </b><b>In</b><b> </b><b>(</b>0<b>,</b><b> </b>2<b>)</b><b>)</b><b>)</b><b> </b><b>into</b><b> </b>:FLogMappingId<b>,</b><b> </b>:FKosulAlani<b>,</b><b> </b>:FKosulDegeri<b>,</b><b> </b>:FKosulOperatoru<b> </b><b>do</b>
<b>    </b><b>begin</b>
<b>        </b>FKosulAlani<b> </b><b>=</b><b> </b><b>Coalesce</b><b>(</b>FKosulAlani<b>,</b><b> </b>''<b>)</b><b>;</b>
<b>        </b>FKosulDegeri<b> </b><b>=</b><b> </b><b>Coalesce</b><b>(</b>FKosulDegeri<b>,</b><b> </b>''<b>)</b><b>;</b>
<b>        </b>FKosulOperatoru<b> </b><b>=</b><b> </b><b>Coalesce</b><b>(</b>FKosulOperatoru<b>,</b><b> </b>''<b>)</b><b>;</b>

<b>        </b><b>if</b><b> </b><b>(</b>FKosulAlani<b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b> </b><b>and</b><b> </b>FKosulDegeri<b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b> </b><b>and</b><b> </b>FKosulOperatoru<b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b>)</b><b> </b><b>then</b>
<b>            </b>FKosulVar<b> </b><b>=</b><b> </b>1<b>;</b>

<b>        </b><b>Select</b><b> </b><b>List</b><b>(</b><b>Distinct</b><b> </b>TabloAlani<b>)</b><b> </b><b>From</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font><b> </b><b>Where</b><b> </b>LogMappingId<b> </b><b>=</b><b> </b>:FLogMappingId<b> </b><b>Into</b><b> </b>:FTabloKolonlari<b>;</b>

<b>        </b><b>if</b><b> </b><b>(</b><b>(</b>FTabloKolonlari<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>and</b><b> </b><b>(</b><b>Trim</b><b>(</b><b>Coalesce</b><b>(</b>FTabloKolonlari<b>,</b>''<b>)</b><b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b>)</b><b>)</b><b> </b><b>then</b>
<b>        </b><b>begin</b>
<b>            </b>FAlanSayisi<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b>FAlanSira<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b>FSqlCumlesi<b> </b><b>=</b><b> </b>''<b>;</b>
<b>            </b>FVirgulPozisyonu<b> </b><b>=</b><b> </b>1<b>;</b>
<b>            </b>FSonVirgulPozisyonu<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b>FAlanUzunluk<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b>LogMasterId<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b>FAlan<b> </b><b>=</b><b> </b>''<b>;</b>
<b>            </b>FDeger<b> </b><b>=</b><b> </b>''<b>;</b>
<b>            </b>FSqlSonucu<b> </b><b>=</b><b> </b>''<b>;</b>
<b>            </b>FKosulUygunMu<b> </b><b>=</b><b> </b>1<b>;</b>
<b>            </b>FKosulSonucu<b> </b><b>=</b><b> </b>0<b>;</b>
<b>            </b><font color="# 080 0"><u>rdb$set_context</u></font><b>(</b>'USER_TRANSACTION'<b>,</b><b> </b>'KosulSonucu'<b>,</b><b> </b>0<b>)</b><b>;</b>

<b>            </b>FDevam<b> </b><b>=</b><b> </b><b>Iif</b><b>(</b><b>Position</b><b>(</b>','<b>,</b><b> </b>FTabloKolonlari<b>,</b><b> </b>1<b>)</b><b> </b><b>&gt;</b><b> </b>0<b>,</b><b> </b>1<b>,</b><b> </b>0<b>)</b><b>;</b>
<b>        </b>
<b>            </b><b>While</b><b> </b><b>(</b>FDevam<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>Do</b>
<b>            </b><b>Begin</b>
<b>                </b>FAlanSayisi<b> </b><b>=</b><b> </b>FAlanSayisi<b> </b><b>+</b><b> </b>1<b>;</b>
<b>                </b>FVirgulPozisyonu<b> </b><b>=</b><b> </b><b>Position</b><b>(</b>','<b>,</b><b> </b>FTabloKolonlari<b>,</b><b> </b>FSonVirgulPozisyonu<b> </b><b>+</b><b> </b>1<b>)</b><b>;</b>
<b>        </b>
<b>                </b><b>if</b><b> </b><b>(</b>FVirgulPozisyonu<b> </b><b>&gt;</b><b> </b>0<b>)</b><b> </b><b>then</b>
<b>                </b><b>begin</b>
<b>                    </b>FAlan<b> </b><b>=</b><b> </b><b>Substring</b><b>(</b>FTabloKolonlari<b> </b><b>from</b><b> </b>FSonVirgulPozisyonu<b> </b><b>+</b><b> </b>1<b> </b><b>for</b><b> </b><b>Iif</b><b>(</b>FAlanUzunluk<b> </b><b>&gt;</b><b> </b>0<b>,</b><b> </b>FVirgulPozisyonu<b> </b><b>-</b><b> </b><b>(</b>FSonVirgulPozisyonu<b> </b><b>+</b><b> </b>1<b>)</b><b>,</b><b> </b>FVirgulPozisyonu<b> </b><b>-</b><b> </b>1<b>)</b><b>)</b><b>;</b>
<b>                    </b>FAlanUzunluk<b> </b><b>=</b><b> </b><b>Char_length</b><b>(</b>FAlan<b>)</b><b>;</b>
<b>                    </b>FSqlCumlesi<b> </b><b>=</b><b> </b>FSqlCumlesi<b> </b><b>|</b><b>|</b><b> </b>'%K'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%'<b> </b><b>|</b><b>|</b><b> </b><b>Trim</b><b>(</b>FAlan<b>)</b><b> </b><b>|</b><b>|</b><b> </b>'%K'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%%D'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%''||Coalesce('<b> </b><b>|</b><b>|</b><b> </b><b>Trim</b><b>(</b>FAlan<b>)</b><b> </b><b>|</b><b>|</b><b> </b>','''')||''%D'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%'<b>;</b>
<b>                    </b>FSonVirgulPozisyonu<b> </b><b>=</b><b> </b>FVirgulPozisyonu<b>;</b>
<b>                    </b>FDevam<b> </b><b>=</b><b> </b>1<b>;</b>
<b>                </b><b>end</b>
<b>                </b><b>else</b>
<b>                </b><b>begin</b>
<b>                    </b>FSqlCumlesi<b> </b><b>=</b><b> </b>FSqlCumlesi<b> </b><b>|</b><b>|</b><b> </b>'%K'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%'<b> </b><b>|</b><b>|</b><b> </b><b>Trim</b><b>(</b><b>Substring</b><b>(</b>FTabloKolonlari<b> </b><b>from</b><b> </b>FSonVirgulPozisyonu<b> </b><b>+</b><b> </b>1<b>)</b><b>)</b><b> </b><b>|</b><b>|</b><b> </b>'%K'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%%D'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%''||Coalesce('<b> </b><b>|</b><b>|</b><b> </b><b>Trim</b><b>(</b><b>Substring</b><b>(</b>FTabloKolonlari<b> </b><b>from</b><b> </b>FSonVirgulPozisyonu<b> </b><b>+</b><b> </b>1<b>)</b><b>)</b><b> </b><b>|</b><b>|</b><b> </b>','''')||''%D'<b> </b><b>|</b><b>|</b><b> </b>FAlanSayisi<b> </b><b>|</b><b>|</b><b> </b>'%'<b>;</b>
<b>                    </b>FDevam<b> </b><b>=</b><b> </b>0<b>;</b>
<b>                </b><b>end</b>
<b>            </b><b>End</b>

<b>            </b><b>Execute</b><b> </b><b>Statement</b><b> </b>'Select '''<b>|</b><b>|</b>FSqlCumlesi<b>|</b><b>|</b>''', '<b>|</b><b>|</b><b>Iif</b><b>(</b>FKosulVar<b> </b><b>=</b><b> </b>1<b>,</b><b> </b>'Case When '<b>|</b><b>|</b>FKosulAlani<b>|</b><b>|</b>' '<b>|</b><b>|</b>FKosulOperatoru<b>|</b><b>|</b>' '<b>|</b><b>|</b>FKosulDegeri<b>|</b><b>|</b>' Then 1 Else 0 End'<b>,</b>'1'<b>)</b><b>|</b><b>|</b>' From '<b>|</b><b>|</b>TabloAdi<b>|</b><b>|</b>' Where '<b>|</b><b>|</b>KeyFieldName<b>|</b><b>|</b>'='''<b>|</b><b>|</b>KeyValue<b>|</b><b>|</b>''''<b> </b><b>Into</b><b> </b>:FSqlSonucu<b>,</b><b> </b>:FKosulSonucu<b>;</b>

<b>            </b><b>if</b><b> </b><b>(</b>CalismaModu<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b>
<b>                 </b><font color="# 080 0"><u>rdb$set_context</u></font><b>(</b>'USER_TRANSACTION'<b>,</b><b> </b>'KosulSonucu'<b>,</b><b> </b>:FKosulSonucu<b>)</b><b>;</b>
<b>            </b><b>else</b><b> </b><b>if</b><b> </b><b>(</b>CalismaModu<b> </b><b>=</b><b> </b>2<b>)</b><b> </b><b>then</b>
<b>                </b>FKosulUygunMu<b> </b><b>=</b><b> </b><b>Iif</b><b>(</b>Tip<b> </b><b>=</b><b> </b>'U'<b>,</b><b> </b><b>Iif</b><b>(</b><b>(</b>FKosulSonucu<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>or</b><b> </b><b>(</b><font color="# 080 0"><u>rdb$get_context</u></font><b>(</b>'USER_TRANSACTION'<b>,</b><b> </b>'KosulSonucu'<b>)</b><b>=</b>'1'<b>)</b><b>,</b><b> </b>1<b>,</b><b> </b>0<b>)</b><b>,</b><b> </b>FKosulUygunMu<b>)</b><b>;</b>

<b>            </b><b>if</b><b> </b><b>(</b><b>(</b>FSqlSonucu<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>and</b><b> </b><b>(</b><b>Trim</b><b>(</b><b>Coalesce</b><b>(</b>FSqlSonucu<b>,</b>''<b>)</b><b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b>)</b><b> </b><b>and</b><b> </b><b>(</b>FKosulUygunMu<b> </b><b>=</b><b> </b>1<b>)</b><b>)</b><b> </b><b>then</b>
<b>            </b><b>Begin</b>
<b>                </b>FSonVirgulPozisyonu<b> </b><b>=</b><b> </b>0<b>;</b>
<b>                </b>FVirgulPozisyonu<b> </b><b>=</b><b> </b>1<b>;</b>
<b>            </b>
<b>                </b><b>While</b><b> </b><b>(</b>FAlanSira<b> </b><b>&lt;</b><b> </b>FAlanSayisi<b>)</b><b> </b><b>do</b>
<b>                </b><b>Begin</b>
<b>                    </b>FAlanSira<b> </b><b>=</b><b> </b>FAlanSira<b> </b><b>+</b><b> </b>1<b>;</b>
<b>                    </b>FKolonTag<b> </b><b>=</b><b> </b>'%K'<b>|</b><b>|</b>FAlanSira<b>|</b><b>|</b>'%'<b>;</b>
<b>                    </b>FDegerTag<b> </b><b>=</b><b> </b>'%D'<b>|</b><b>|</b>FAlanSira<b>|</b><b>|</b>'%'<b>;</b>
<b>            </b>
<b>                    </b>FKolonTagPozisyonu1<b> </b><b>=</b><b> </b><b>Position</b><b>(</b>FKolonTag<b>,</b><b> </b>FSqlSonucu<b>)</b><b>;</b>
<b>                    </b>FKolonTagPozisyonu2<b> </b><b>=</b><b> </b><b>Position</b><b>(</b>FKolonTag<b>,</b><b> </b>FSqlSonucu<b>,</b><b> </b><b>Char_length</b><b>(</b>FKolonTag<b>)</b><b> </b><b>+</b><b> </b>FKolonTagPozisyonu1<b>)</b><b>;</b><b>                                                     </b>
<b>            </b>
<b>                    </b>FDegerTagPozisyonu1<b> </b><b>=</b><b> </b><b>Position</b><b>(</b>FDegerTag<b>,</b><b> </b>FSqlSonucu<b>)</b><b>;</b>
<b>                    </b>FDegerTagPozisyonu2<b> </b><b>=</b><b> </b><b>Position</b><b>(</b>FDegerTag<b>,</b><b> </b>FSqlSonucu<b>,</b><b> </b><b>Char_length</b><b>(</b>FDegerTag<b>)</b><b> </b><b>+</b><b> </b>FDegerTagPozisyonu1<b>)</b><b>;</b>
<b>            </b>
<b>                    </b>FKolon<b> </b><b>=</b><b> </b><b>Upper</b><b>(</b><b>Trim</b><b>(</b><b>Substring</b><b>(</b>FSqlSonucu<b> </b><b>from</b><b> </b>FKolonTagPozisyonu1<b> </b><b>+</b><b> </b><b>Char_length</b><b>(</b>FKolonTag<b>)</b><b> </b><b>for</b><b> </b><b>(</b>FKolonTagPozisyonu2<b> </b><b>-</b><b> </b><b>(</b>FKolonTagPozisyonu1<b> </b><b>+</b><b> </b><b>Char_length</b><b>(</b>FKolonTag<b>)</b><b>)</b><b>)</b><b>)</b><b>)</b><b>)</b><b>;</b>
<b>                    </b>FDeger<b> </b><b>=</b><b> </b><b>Trim</b><b>(</b><b>Substring</b><b>(</b>FSqlSonucu<b> </b><b>from</b><b> </b>FDegerTagPozisyonu1<b> </b><b>+</b><b> </b><b>Char_length</b><b>(</b>FDegerTag<b>)</b><b> </b><b>for</b><b> </b><b>(</b>FDegerTagPozisyonu2<b> </b><b>-</b><b> </b><b>(</b>FDegerTagPozisyonu1<b> </b><b>+</b><b> </b><b>Char_length</b><b>(</b>FDegerTag<b>)</b><b>)</b><b>)</b><b>)</b><b>)</b><b>;</b>
<b>            </b>
<b>                    </b><b>if</b><b> </b><b>(</b><b>Coalesce</b><b>(</b>FKolon<b>,</b><b> </b>''<b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b> </b><b>or</b><b> </b><b>Coalesce</b><b>(</b>FDeger<b>,</b><b> </b>''<b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b>)</b><b> </b><b>then</b>
<b>                    </b><b>begin</b>
<b>                        </b><b>for</b><b> </b><b>Select</b><b> </b><b>Upper</b><b>(</b><font color="# 080 0"><u>LogMappingDetail</u></font><b>.</b>TabloAlani<b>)</b><b>,</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font><b>.</b>ForeignTablo<b>,</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font><b>.</b>ForeignTabloDegerAlani<b> </b><b>From</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font>
<b>                            </b><b>Where</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font><b>.</b>LogMappingId<b> </b><b>=</b><b> </b>:FLogMappingId<b> </b><b>And</b><b> </b><font color="# 080 0"><u>LogMappingDetail</u></font><b>.</b>Kapali<b> </b><b>=</b><b> </b>0<b> </b><b>into</b><b> </b>:FLogMappingDetailAlani<b>,</b><b> </b>:FForeignTablo<b>,</b><b> </b>:FForeignTabloDegerAlani<b> </b><b>do</b>
<b>                        </b><b>begin</b>
<b>                            </b><b>if</b><b> </b><b>(</b>FKolon<b> </b><b>=</b><b> </b>FLogMappingDetailAlani<b>)</b><b> </b><b>then</b>
<b>                            </b><b>begin</b>
<b>                              </b>FForeignTabloAlani<b> </b><b>=</b><b> </b><b>null</b><b>;</b>
<b>                                </b><b>if</b><b> </b><b>(</b><b>Coalesce</b><b>(</b>FDeger<b>,</b><b> </b>''<b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b>''<b>)</b><b> </b><b>then</b>
<b>                                </b><b>begin</b>
<b>                                    </b><b>Select</b><b> </b>ForeignKolon<b> </b><b>From</b><b> </b><font color="# 080 0"><u>ForeignKeyVarMi</u></font><b>(</b>:FKolon<b>,</b><b> </b>:TabloAdi<b>)</b><b> </b><b>Into</b><b> </b>:FForeignTabloAlani<b>;</b>
<b>                                    </b><b>if</b><b> </b><b>(</b>FForeignTabloDegerAlani<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>Null</b><b> </b><b>and</b><b> </b>FForeignTablo<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b> </b><b>and</b><b> </b>FForeignTabloAlani<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b>
<b>                                        </b><b>execute</b><b> </b><b>statement</b><b> </b>'select '<b>|</b><b>|</b>FForeignTabloDegerAlani<b>|</b><b>|</b>' || '' ('<b>|</b><b>|</b>FForeignTabloAlani<b>|</b><b>|</b>'='<b>|</b><b>|</b>FDeger<b>|</b><b>|</b>')'' from '<b>|</b><b>|</b>FForeignTablo<b>|</b><b>|</b>' where '<b>|</b><b>|</b>FForeignTabloAlani<b>|</b><b>|</b>'='''<b>|</b><b>|</b>FDeger<b>|</b><b>|</b>''''<b> </b><b>into</b><b> </b>:FDeger<b>;</b>
<b>                                </b><b>end</b>
<b>    </b>
<b>                                </b><b>if</b><b> </b><b>(</b>CalismaModu<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b>
<b>                                    </b><font color="# 080 0"><u>rdb$set_context</u></font><b>(</b>'USER_TRANSACTION'<b>,</b><b> </b>:FKolon<b>,</b><b> </b><b>cast</b><b>(</b>:FDeger<b> </b><b>As</b><b> </b><b>blob</b><b> </b><b>character</b><b> </b><b>set</b><b> </b>utf8<b>)</b><b>)</b><b>;</b>
<b>                                </b><b>else</b>
<b>                                </b><b>begin</b>
<b>                                    </b><b>if</b><b> </b><b>(</b>Tip<b> </b><b>=</b><b> </b>'U'<b>)</b><b> </b><b>then</b>
<b>                                        </b>FDegerEski<b> </b><b>=</b><b> </b><font color="# 080 0"><u>rdb$get_context</u></font><b>(</b>'USER_TRANSACTION'<b>,</b><b> </b>:FKolon<b>)</b><b>;</b>
<b>                                </b>
<b>                                    </b><b>if</b><b> </b><b>(</b><b>(</b><b>(</b><b>Coalesce</b><b>(</b>FDegerEski<b>,</b><b> </b>'null'<b>)</b><b> </b><b>&lt;</b><b>&gt;</b><b> </b><b>Coalesce</b><b>(</b>FDeger<b>,</b><b> </b>'null'<b>)</b><b>)</b><b> </b><b>and</b><b> </b>Tip<b> </b><b>=</b><b> </b>'U'<b>)</b><b> </b><b>or</b><b> </b><b>(</b>Tip<b> </b><b>=</b><b> </b>'D'<b>)</b><b>)</b><b>  </b><b>then</b>
<b>                                    </b><b>begin</b>
<b>                                        </b><b>if</b><b> </b><b>(</b>LogMasterId<b> </b><b>=</b><b> </b>0<b>)</b><b> </b><b>then</b>
<b>                                        </b><b>begin</b>
<b>                                            </b>LogMasterId<b> </b><b>=</b><b> </b><b>gen_id</b><b>(</b><font color="# 080 0"><u>LogMaster_Id_Gen</u></font><b>,</b><b> </b>1<b>)</b><b>;</b>
<b>                                            </b><b>insert</b><b> </b><b>into</b><b> </b><font color="# 080 0"><u>LogMaster</u></font><b>(</b>LogMasterId<b>,</b><b> </b>Tip<b>,</b><b> </b>TabloAdi<b>,</b><b> </b>KeyValue<b>,</b><b> </b>Anahtar<b>,</b><b> </b>Tarih<b>,</b><b> </b>KullaniciId<b>)</b><b> </b><b>values</b><b> </b><b>(</b>:LogMasterId<b>,</b><b> </b>:Tip<b>,</b><b> </b>:TabloAdi<b>,</b><b> </b>:KeyValue<b>,</b><b> </b>:Anahtar<b>,</b><b> </b><b>current_timestamp</b><b>(</b>0<b>)</b><b>,</b><b> </b><b>Coalesce</b><b>(</b><font color="# 080 0"><u>rdb$get_context</u></font><b>(</b>'USER_SESSION'<b>,</b><b> </b>'KULLANICIID'<b>)</b><b>,</b><b> </b>1<b>)</b><b>)</b><b>;</b>
<b>                                        </b><b>end</b>
<b>                                        </b><b>insert</b><b> </b><b>into</b><b> </b><font color="# 080 0"><u>LogDetay</u></font><b> </b><b>(</b>LogMasterId<b>,</b><b> </b>FieldName<b>,</b><b> </b>OldValue<b>,</b><b> </b>NewValue<b>)</b><b> </b><b>values</b><b> </b><b>(</b>:LogMasterId<b>,</b><b> </b>:FKolon<b>,</b><b> </b><b>Substring</b><b>(</b><b>Iif</b><b>(</b>:Tip<b> </b><b>=</b><b> </b>'U'<b>,</b><b> </b><b>cast</b><b>(</b>:FDegerEski<b> </b><b>As</b><b> </b><b>blob</b><b> </b><b>character</b><b> </b><b>set</b><b> </b>utf8<b>)</b><b>,</b><b> </b><b>cast</b><b>(</b>:FDeger<b> </b><b>As</b><b> </b><b>blob</b><b> </b><b>character</b><b> </b><b>set</b><b> </b>utf8<b>)</b><b>)</b><b> </b><b>From</b><b> </b>1<b> </b><b>For</b><b> </b>255<b>)</b><b>,</b><b> </b><b>Substring</b><b>(</b><b>Iif</b><b>(</b>:Tip<b> </b><b>=</b><b> </b>'U'<b>,</b><b> </b><b>cast</b><b>(</b>:FDeger<b> </b><b>As</b><b> </b><b>blob</b><b> </b><b>character</b><b> </b><b>set</b><b> </b>utf8<b>)</b><b>,</b><b> </b><b>null</b><b>)</b><b> </b><b>From</b><b> </b>1<b> </b><b>For</b><b> </b>255<b>)</b><b>)</b><b>;</b>
<b>                                    </b><b>end</b>
<b>                                </b><b>end</b><font color="# 0 0FF"><i>--CalismaModu</i></font>
<b>                            </b><b>end</b><font color="# 0 0FF"><i>--(FKolon = FLogMappingDetailAlani)</i></font>
<b>                        </b><b>end</b><font color="# 0 0FF"><i>--for Select LogMappingDetail</i></font>
<b>                    </b><b>end</b><font color="# 0 0FF"><i>--(Coalesce(FKolon, '') &lt;&gt; '' or Coalesce(FDeger, '') &lt;&gt; '')</i></font>
<b>                </b><b>end</b><font color="# 0 0FF"><i>--While (FAlanSira &lt; FAlanSayisi) do</i></font>
<b>            </b><b>end</b><font color="# 0 0FF"><i>--FSqlSonucu is not null</i></font>
<b>        </b><b>end</b><font color="# 0 0FF"><i>--(FTabloKolonlari is not null)</i></font>
<b>    </b><b>end</b><font color="# 0 0FF"><i>--for Select LogMapping</i></font>
<b>end</b>

</pre></code>
</span></P>
<P CLASS="Base">&nbsp;</P>
<DIV CLASS="footer"><BR><HR></DIV>
  <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH=100%>
    <TR VALIGN="middle">
      <TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
      <TD ALIGN="left" WIDTH="54px" NOWRAP>
        <A HREF="LOGGETIR.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
        <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
        <A HREF="LOGMAPPINGDETAILGETIR.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
      </TD>
    </TR>
  </TABLE>
<P CLASS="Base">&nbsp;</P>
</BODY></HTML>