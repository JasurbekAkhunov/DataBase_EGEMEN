<HTML>
<HEAD>
<TITLE>ISLETMEDEKIPARTILERINLISTESI_CH</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK HREF="../IBEHTMLDoc.css" type=text/css rel=STYLESHEET>
 
<xml>
<IBEHelp:Attr Name="ItemOrder" Value="930800"/>
</xml>
 
</HEAD>
<BODY>
<DIV ID="nsbanner">
  <DIV ID="bannerrow1">
    <TABLE CLASS="bannerparthead" CELLSPACING=0>
      <TR ID="hdr" VALIGN="middle">
        <TD CLASS="runninghead">"E:\Egemen\EB01\Dataserver\DATA\FERGANAGLOBAL\EB01DATA.GDB". Procedures</TD>
        <TD ALIGN="left" WIDTH="54px" NOWRAP>
          <A HREF="ISLETMEDEKIPARTILERINLISTESI_BF.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
          <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
          <A HREF="ISLETMEDEKIPARTILERINTOPLAMI.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
        </TD>
      </TR>
    </TABLE>
  </DIV>
  <DIV ID="TitleRow">
    <P CLASS="dtH1">ISLETMEDEKIPARTILERINLISTESI_CH</P>
  </DIV>
 </DIV>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Input Parameters</P>
<TABLE CLASS="dtArg" CELLSPACING="0">
  <TH WIDTH="1%"><P CLASS="Base2"><B>Parameter</B></P>
  <TH WIDTH="20%"><P CLASS="Base2"><B>Type</B></P>
  <TH WIDTH="50%"><P CLASS="Base2"><B>Description</B></P>
  <TR>
    <TD><P CLASS="Base2">ISLEMGRUBUID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">DURUMU</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ISLEMTIPIID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FFATURAKESILECEK</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARTIONAYDURUMU</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FASON</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">YURTDISI</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARCALISEVK</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FPARTITAMIRSINIFID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARTISINIFID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARTIKAYITID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FSONYAPILANSIRA</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONPARTIASAMALARIID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TEKRARURETIM</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
</TABLE>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Output Parameters</P>
<TABLE CLASS="dtArg" CELLSPACING="0">
  <TH WIDTH="1%"><P CLASS="Base2"><B>Parameter</B></P>
  <TH WIDTH="20%"><P CLASS="Base2"><B>Type</B></P>
  <TH WIDTH="50%"><P CLASS="Base2"><B>Description</B></P>
  <TR>
    <TD><P CLASS="Base2">BOYADURUMU</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">BOYADURUMUSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(10)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">UCRETLITAMIR</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">UCRETLITAMIRSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(20)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">YURTDISISTR</TD>
    <TD><P CLASS="Base2">VARCHAR(9)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">FASONSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(5)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARTIONAYDURUMUSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(4)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">PARCALISEVKSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(4)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ISLETMEICITAMIR</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ISLETMEICITAMIRSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(8)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">BEKLEMEDE</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">BEKLEMEDESTR</TD>
    <TD><P CLASS="Base2">VARCHAR(4)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">HAMSTOKGIRISTARIHI</TD>
    <TD><P CLASS="Base2">TIMESTAMP</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">HAMSTOKGIRISIRSALIYENO</TD>
    <TD><P CLASS="Base2">NUMERIC(18,0)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONMAKINAID</TD>
    <TD><P CLASS="Base2">VARCHAR(10)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">CIKISRAFID</TD>
    <TD><P CLASS="Base2">VARCHAR(30)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONRAKIASAMAADI</TD>
    <TD><P CLASS="Base2">VARCHAR(40)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONRAKIASAMAID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONRAKIASAMAGURAPORUSIRANO</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">SONRAKIASAMAGURAPORGRUPNO</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TAMIRCOZUMSEKLIID</TD>
    <TD><P CLASS="Base2">INTEGER</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TAMIRCOZUMSEKLIADI</TD>
    <TD><P CLASS="Base2">VARCHAR(30)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TEKRARURETIMSTR</TD>
    <TD><P CLASS="Base2">VARCHAR(20)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">TAMIRNOTU</TD>
    <TD><P CLASS="Base2">BLOB SUB_TYPE 0 SEGMENT SIZE 80</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
  <TR>
    <TD><P CLASS="Base2">ICTAMIRTIPIADI</TD>
    <TD><P CLASS="Base2">VARCHAR(20)</TD>
    <TD><P CLASS="Base2">&nbsp;</TD>
  </TR>
</TABLE>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Description</P>
<P CLASS="Base"><I>(There is no description for procedure ISLETMEDEKIPARTILERINLISTESI_CH)</I></P>
<P CLASS="Base">&nbsp;</P>
<P CLASS="Header1">Definition</P>
<P CLASS="Base"><span class="DDLCode">
<code><pre>
<b>CREATE</b><b> </b><b>PROCEDURE</b><b> </b><font color="# 080 0"><u>ISLETMEDEKIPARTILERINLISTESI_CH</u></font><b>(</b>
<b>    </b>ISLEMGRUBUID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>DURUMU<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>ISLEMTIPIID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>FFATURAKESILECEK<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>PARTIONAYDURUMU<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>FASON<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>YURTDISI<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>PARCALISEVK<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>FPARTITAMIRSINIFID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>PARTISINIFID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>PARTIKAYITID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>FSONYAPILANSIRA<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>SONPARTIASAMALARIID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>TEKRARURETIM<b> </b><b>INTEGER</b><b>)</b>
<b>RETURNS</b><b> </b><b>(</b>
<b>    </b>BOYADURUMU<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>BOYADURUMUSTR<b> </b><b>VARCHAR</b><b>(</b>10<b>)</b><b>,</b>
<b>    </b>UCRETLITAMIR<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>UCRETLITAMIRSTR<b> </b><b>VARCHAR</b><b>(</b>20<b>)</b><b>,</b>
<b>    </b>YURTDISISTR<b> </b><b>VARCHAR</b><b>(</b>9<b>)</b><b>,</b>
<b>    </b>FASONSTR<b> </b><b>VARCHAR</b><b>(</b>5<b>)</b><b>,</b>
<b>    </b>PARTIONAYDURUMUSTR<b> </b><b>VARCHAR</b><b>(</b>4<b>)</b><b>,</b>
<b>    </b>PARCALISEVKSTR<b> </b><b>VARCHAR</b><b>(</b>4<b>)</b><b>,</b>
<b>    </b>ISLETMEICITAMIR<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>ISLETMEICITAMIRSTR<b> </b><b>VARCHAR</b><b>(</b>8<b>)</b><b>,</b>
<b>    </b>BEKLEMEDE<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>BEKLEMEDESTR<b> </b><b>VARCHAR</b><b>(</b>4<b>)</b><b>,</b>
<b>    </b>HAMSTOKGIRISTARIHI<b> </b><b>TIMESTAMP</b><b>,</b>
<b>    </b>HAMSTOKGIRISIRSALIYENO<b> </b><font color="# 080 0"><u>IRSALIYENOSIZE</u></font><b>,</b>
<b>    </b>SONMAKINAID<b> </b><b>VARCHAR</b><b>(</b>10<b>)</b><b>,</b>
<b>    </b>CIKISRAFID<b> </b><b>VARCHAR</b><b>(</b>30<b>)</b><b>,</b>
<b>    </b>SONRAKIASAMAADI<b> </b><b>VARCHAR</b><b>(</b>40<b>)</b><b>,</b>
<b>    </b>SONRAKIASAMAID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>SONRAKIASAMAGURAPORUSIRANO<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>SONRAKIASAMAGURAPORGRUPNO<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>TAMIRCOZUMSEKLIID<b> </b><b>INTEGER</b><b>,</b>
<b>    </b>TAMIRCOZUMSEKLIADI<b> </b><b>VARCHAR</b><b>(</b>30<b>)</b><b>,</b>
<b>    </b>TEKRARURETIMSTR<b> </b><b>VARCHAR</b><b>(</b>20<b>)</b><b>,</b>
<b>    </b>TAMIRNOTU<b> </b><b>BLOB</b><b> </b><b>SUB_TYPE</b><b> </b>0<b> </b><b>SEGMENT</b><b> </b><b>SIZE</b><b> </b>80<b>,</b>
<b>    </b>ICTAMIRTIPIADI<b> </b><b>VARCHAR</b><b>(</b>20<b>)</b><b>)</b>
<b>AS</b>
<b>declare</b><b> </b><b>variable</b><b> </b>KayitSayisi<b> </b><b>integer</b><b>;</b>
<b>declare</b><b> </b><b>variable</b><b> </b>FSonrakiSira<b>     </b><b>integer</b><b>;</b>
<b>begin</b>
<b>  </b><b>if</b><b> </b><b>(</b>IslemGrubuId<b> </b><b>&lt;</b><b>&gt;</b><b> </b>4<b>)</b><b> </b><b>then</b>
<b>  </b><b>begin</b>
<b>    </b><b>if</b><b> </b><b>(</b>Durumu<b> </b><b>&lt;</b><b> </b>4<b>)</b><b> </b><b>then</b>
<b>    </b><b>begin</b>
<b>      </b>BoyaDurumu<b> </b><b>=</b><b> </b>1<b>;</b>
<b>      </b>BoyaDurumuStr<b> </b><b>=</b><b> </b>'Boyanacak'<b>;</b>
<b>    </b><b>end</b>
<b>    </b><b>else</b>
<b>    </b><b>begin</b>
<b>      </b>BoyaDurumu<b> </b><b>=</b><b> </b>0<b>;</b>
<b>      </b>BoyaDurumuStr<b> </b><b>=</b><b> </b>'Boyandı'<b>;</b>
<b>    </b><b>end</b>
<b>  </b><b>end</b>
<b>  </b><b>else</b>
<b>  </b><b>begin</b>
<b>    </b>BoyaDurumu<b> </b><b>=</b><b> </b><b>null</b><b>;</b>
<b>    </b>BoyaDurumuStr<b> </b><b>=</b><b> </b>''<b>;</b>
<b>  </b><b>end</b>

<b>  </b>UcretliTamir<b> </b><b>=</b><b> </b>0<b>;</b>
<b>  </b>UcretliTamirStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>IslemTipiID<b> </b><b>=</b><b> </b>3<b> </b><b>and</b><b> </b>FFaturaKesilecek<b> </b><b>=</b><b> </b>0<b>)</b><b> </b><b>then</b>
<b>    </b>UcretliTamirStr<b> </b><b>=</b><b> </b>'Ücretsiz Tamir'<b>;</b>
<b>  </b><b>else</b><b> </b><b>if</b><b> </b><b>(</b>IslemTipiID<b> </b><b>=</b><b> </b>3<b> </b><b>and</b><b> </b>FFaturaKesilecek<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b>
<b>  </b><b>begin</b>
<b>    </b>UcretliTamirStr<b> </b><b>=</b><b> </b>'Ücretli Tamir'<b>;</b>
<b>    </b>UcretliTamir<b> </b><b>=</b><b> </b>1<b>;</b>
<b>  </b><b>end</b>

<b>  </b><b>if</b><b> </b><b>(</b>PartiOnayDurumu<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b> </b>PartiOnayDurumuStr<b> </b><b>=</b><b> </b>'Evet'<b>;</b>
<b>  </b><b>else</b><b> </b>PartiOnayDurumuStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>Fason<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b>  </b>FasonStr<b> </b><b>=</b><b> </b>'Fason'<b>;</b><b> </b><b>else</b><b> </b>FasonStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>YurtDisi<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b> </b>YurtDisiStr<b> </b><b>=</b><b> </b>'Yurt Dışı'<b>;</b>
<b>  </b><b>else</b><b> </b>YurtDisiStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>TekrarUretim<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b> </b>TekrarUretimStr<b> </b><b>=</b><b> </b>'Tekrar Üretim'<b>;</b>
<b>  </b><b>else</b><b> </b>TekrarUretimStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>ParcaliSevk<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b> </b>ParcaliSevkStr<b> </b><b>=</b><b> </b>'Evet'<b>;</b>
<b>  </b><b>else</b><b> </b>ParcaliSevkStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b>TamirCozumSekliId<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>  </b>TamirCozumSekliAdi<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>  </b>TamirNotu<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>  </b>IcTamirTipiAdi<b> </b><b>=</b><b> </b>''<b>;</b>
<b>  </b><b>if</b><b> </b><b>(</b>FPartiTamirSinifId<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b>
<b>  </b><b>begin</b>
<b>    </b>IsletmeIciTamir<b> </b><b>=</b><b> </b>1<b>;</b>
<b>    </b>IsletmeIciTamirStr<b> </b><b>=</b><b> </b>'İç Tamir'<b>;</b>
<b>    </b><b>select</b><b> </b><b>first</b><b> </b>1<b> </b><font color="# 080 0"><u>PartiTamir</u></font><b>.</b>TamirCozumSekliId<b>,</b><b> </b><font color="# 080 0"><u>TamirCozumSekli</u></font><b>.</b>Adi<b>,</b><b> </b><font color="# 080 0"><u>PartiTamir</u></font><b>.</b>Notu<b>,</b><b> </b><font color="# 080 0"><u>TamirTipi</u></font><b>.</b>Adi<b>  </b><b>from</b><b> </b><font color="# 080 0"><u>PartiTamirSinif</u></font>
<b>     </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>PartiTamir</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>PartiTamir</u></font><b>.</b>PartiTamirId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartitamirSinif</u></font><b>.</b>PartiTamirId
<b>     </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>TamirCozumSekli</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>TamirCozumSekli</u></font><b>.</b>TamirCozumSekliid<b> </b><b>=</b><b> </b><font color="# 080 0"><u>Partitamir</u></font><b>.</b>TamirCozumSekliId
<b>     </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>TamirTipi</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>TamirTipi</u></font><b>.</b>TamirTipiId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiTamir</u></font><b>.</b>TamirTipiId
<b>     </b><b>where</b><b> </b>PartiTamirSinifId<b> </b><b>=</b><b> </b>:FPartiTamirSinifId
<b>     </b><b>into</b><b> </b>:TamirCozumSekliId<b>,</b><b> </b>:TamirCozumSekliAdi<b>,</b><b> </b>:TamirNotu<b>,</b><b> </b>:IcTamirTipiAdi<b>;</b>
<b>  </b><b>end</b>
<b>  </b><b>else</b>
<b>  </b><b>begin</b>
<b>    </b>IsletmeIciTamir<b> </b><b>=</b><b> </b>0<b>;</b>
<b>    </b>IsletmeIciTamirStr<b> </b><b>=</b><b> </b>''<b>;</b>
<b>    </b>IcTamirTipiAdi<b> </b><b>=</b><b> </b>''<b>;</b>
<b>  </b><b>end</b>

<b>  </b><b>Select</b><b> </b><b>Count</b><b>(</b><b>*</b><b>)</b><b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiStokBekle</u></font><b> </b><b>where</b><b> </b><font color="# 080 0"><u>PartiStokBekle</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiStokBekle</u></font><b>.</b>Bitti<b> </b><b>=</b><b> </b>0<b> </b><b>into</b><b> </b>:KayitSayisi<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>KayitSayisi<b> </b><b>&gt;</b><b> </b>0<b>)</b><b> </b><b>then</b><b> </b>Beklemede<b> </b><b>=</b><b> </b>1<b>;</b>
<b>  </b><b>else</b><b> </b>Beklemede<b> </b><b>=</b><b> </b>0<b>;</b>

<b>  </b><b>if</b><b> </b><b>(</b>Beklemede<b> </b><b>=</b><b> </b>1<b>)</b><b> </b><b>then</b><b> </b>BeklemedeStr<b> </b><b>=</b><b> </b>'Evet'<b>;</b>
<b>  </b><b>else</b><b> </b>BeklemedeStr<b> </b><b>=</b><b> </b>''<b>;</b>

<b>  </b><b>Select</b><b> </b><b>First</b><b> </b>1<b> </b><font color="# 080 0"><u>HamStokIrsaliye</u></font><b>.</b>IrsaliyeTarihi<b>,</b><b> </b><font color="# 080 0"><u>HamStokIrsaliye</u></font><b>.</b>IrsaliyeNo<b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiStokDetay</u></font>
<b>    </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>RafDetay</u></font><b>  </b><b>on</b><b> </b><font color="# 080 0"><u>rafDetay</u></font><b>.</b>RafDetayId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiStokDetay</u></font><b>.</b>RafDetayId
<b>    </b><b>left</b><b> </b><b>Join</b><b> </b><font color="# 080 0"><u>HamStokIrsaliye</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>HamStokIrsaliye</u></font><b>.</b>HamStokIrsaliyeId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>RafDetay</u></font><b>.</b>HamStokIrsaliyeId
<b>    </b><b>where</b><b> </b><font color="# 080 0"><u>PartiStokDetay</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId
<b>    </b><b>order</b><b> </b><b>by</b><b> </b><font color="# 080 0"><u>HamStokIrsaliye</u></font><b>.</b>IrsaliyeTarihi<b> </b><b>desc</b>
<b>    </b><b>into</b><b> </b>:HamStokGirisTarihi<b>,</b><b> </b>:HamStokGirisIrsaliyeNo<b>;</b>

<b>    </b>SonrakiAsamaAdi<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>    </b>SonrakiAsamaId<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>    </b>SonrakiAsamaGURaporuSiraNo<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>    </b>SonrakiAsamaGURaporGrupNo<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>    </b>SonMakinaId<b> </b><b>=</b><b> </b><b>Null</b><b>;</b>
<b>    </b>CikisRafId<b> </b><b>=</b><b> </b>''<b>;</b>

<b>    </b><b>if</b><b> </b><b>(</b>FSonYapilanSira<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b>
<b>    </b><b>begin</b>
<b>      </b><b>Select</b><b> </b>CikisRafID<b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiSinifSonCikisRafGetir</u></font><b>(</b>:PartiKayitId<b>,</b><b> </b>:PartiSinifId<b>)</b><b> </b><b>into</b><b> </b>:CikisRafId<b>;</b>

<b>      </b><b>select</b><b> </b><b>Min</b><b>(</b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>Sira<b>)</b><b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font>
<b>        </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>PartiAsamalariId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiAsamalariId
<b>        </b><b>where</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>AsamayaDahil<b> </b><b>=</b><b> </b>1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>Sira<b> </b><b>&gt;</b><b> </b>:FSonYapilanSira
<b>        </b><b>into</b><b> </b>:FSonrakiSira<b>;</b>

<b>      </b><b>Select</b><b> </b><b>Min</b><b>(</b><font color="# 080 0"><u>Makina</u></font><b>.</b>MakinaId<b>)</b><b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiAsamaStokDetay</u></font>
<b>          </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>Makina</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>Makina</u></font><b>.</b>MakinaID<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiAsamaStokDetay</u></font><b>.</b>MakinaId
<b>          </b><b>where</b><b> </b><font color="# 080 0"><u>PartiAsamaStokDetay</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamaStokDetay</u></font><b>.</b>PartiAsamalariId<b> </b><b>=</b><b> </b>:SonPartiAsamalariId<b> </b><b>into</b><b> </b>:SonMakinaId<b>;</b>
<b>    </b><b>end</b>
<b>    </b><b>else</b>
<b>    </b><b>begin</b>
<b>      </b><b>select</b><b> </b><b>Min</b><b>(</b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>Sira<b>)</b><b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font>
<b>        </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>PartiAsamalariId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiAsamalariId
<b>        </b><b>where</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>AsamayaDahil<b> </b><b>=</b><b> </b>1<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>Sira<b> </b><b>&gt;</b><b> </b><b>-</b>1
<b>        </b><b>into</b><b> </b>:FSonrakiSira<b>;</b>
<b>    </b><b>end</b>
<b>    </b><b>if</b><b> </b><b>(</b>FSonrakiSira<b> </b><b>is</b><b> </b><b>not</b><b> </b><b>null</b><b>)</b><b> </b><b>then</b>
<b>    </b><b>begin</b>
<b>      </b><b>select</b><b> </b><font color="# 080 0"><u>Asama</u></font><b>.</b>Adi<b>,</b><b> </b><font color="# 080 0"><u>Asama</u></font><b>.</b>AsamaId<b>,</b><b> </b><font color="# 080 0"><u>Asama</u></font><b>.</b>GURaporuSiraNo<b>,</b><b> </b><font color="# 080 0"><u>Asama</u></font><b>.</b>GURaporGrupNo<b> </b><b>from</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font>
<b>        </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>Asama</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>Asama</u></font><b>.</b>AsamaId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>AsamaId
<b>        </b><b>left</b><b> </b><b>join</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b> </b><b>on</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>PartiAsamalariId<b> </b><b>=</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiAsamalariId
<b>        </b><b>where</b><b> </b><font color="# 080 0"><u>PartiAsamaStok</u></font><b>.</b>PartiSinifId<b> </b><b>=</b><b> </b>:PartiSinifId<b> </b><b>and</b><b> </b><font color="# 080 0"><u>PartiAsamalari</u></font><b>.</b>Sira<b> </b><b>=</b><b> </b>:FSonrakiSira
<b>        </b><b>into</b><b> </b>:SonrakiAsamaAdi<b>,</b><b> </b>:SonrakiAsamaId<b>,</b><b> </b>:SonrakiAsamaGURaporuSiraNo<b>,</b><b> </b>:SonrakiAsamaGURaporGrupNo<b>;</b>
<b>    </b><b>end</b>

<b>  </b><b>Suspend</b><b>;</b>
<b>end</b>

</pre></code>
</span></P>
<P CLASS="Base">&nbsp;</P>
<DIV CLASS="footer"><BR><HR></DIV>
  <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH=100%>
    <TR VALIGN="middle">
      <TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
      <TD ALIGN="left" WIDTH="54px" NOWRAP>
        <A HREF="ISLETMEDEKIPARTILERINLISTESI_BF.html"><IMG ALT="Previous topic" SRC="../Images/GoPrev.gif" BORDER="0"></A>
        <A HREF="../Index.html"><IMG ALT="Chapter index" SRC="../Images/GoIndex.gif" BORDER="0"></A>
        <A HREF="ISLETMEDEKIPARTILERINTOPLAMI.html"><IMG ALT="Next topic" SRC="../Images/GoNext.gif" BORDER="0"></A>
      </TD>
    </TR>
  </TABLE>
<P CLASS="Base">&nbsp;</P>
</BODY></HTML>